H{1,1}=(1/sqrt(2))*[-0.9704 + 0.4012i (1.9144 - 0.3561i);(0.4516 - 1.4800i) 0.0501 - 0.1627i];
H{1,2}=0.8*(1/sqrt(2))*[-0.6337 + 0.8001i (-1.1485 + 0.2689i);(0.4516 - 1.4800i) -0.6651 - 0.9268i];
H{2,1}=0.8*(1/sqrt(2))*[-0.0165 + 0.9251i (-1.0463 - 0.5763i);(-0.1497 - 1.5829i) -0.7804 - 0.4109i];
H{2,2}=(1/sqrt(2))*[-0.9313 + 0.8060i (0.7313 + 0.0698i);(-0.2850 + 1.1345i) -0.5113 - 0.1662i];

sigma = 10^(-6);

gc(:,1) = [-0.1570 - 1.1223i; 1.9178 + 0.2697i];
gp(:,1) = [ 0.6473 - 1.1667i;-0.3318 + 1.2201i];
gc(:,2) = [-2.0405 + 0.1186i;0.2665 - 0.1111i];
gp(:,2) = [-0.0690 + 0.2588i;1.4652 + 0.5898i];

%{
vc(:,1) = [0.0202 - 0.2230i,0.2441 - 0.0896i];
vc(:,1)=vc(:,1)/norm(vc(:,1));
vp(:,1) = [-0.0182 + 0.1862i;0.0271 - 0.3801i];
vp(:,1)=vp(:,1)/norm(vp(:,1));
vc(:,2) = [0.1333 - 0.0615i,-0.3273 - 0.0058i];
vc(:,2)=vc(:,2)/norm(vc(:,2));
vp(:,2) = [-0.1161 + 0.1096i;-0.3259 - 0.1662i];
vp(:,2)=vp(:,2)/norm(vp(:,2));
%}

vc(:,1) = [0.0938 - 0.1661i,0.1833 + 0.0608i];
vc(:,1)=vc(:,1)/norm(vc(:,1));
vp(:,1) = [-0.0171 + 0.1863i;0.0262 - 0.3801i];
vp(:,1)=vp(:,1)/norm(vp(:,1));
vc(:,2) = [0.1053 - 0.0461i,-0.0980 + 0.2426i];
vc(:,2)=vc(:,2)/norm(vc(:,2));
vp(:,2) = [-0.1158 + 0.1134i;-0.3250 - 0.1631i];
vp(:,2)=vp(:,2)/norm(vp(:,2));



SINR_C(1)=(   norm( gc(:,1)'*H{1,1}*vc(:,1)+gc(:,2)'*H{1,2}*vc(:,2) )^2   )/( norm( gc(:,1)'*sigma^2*gc(:,1) ) +  norm( gc(:,1)'*H{1,1}*vp(:,1)+gc(:,1)'*H{1,2}*vp(:,2) )^2  );
SINR_C(2)=(   norm( gc(:,2)'*H{2,1}*vc(:,1)+gc(:,2)'*H{2,2}*vc(:,2) )^2   )/( norm( gc(:,2)'*sigma^2*gc(:,2) ) +  norm( gc(:,2)'*H{2,1}*vp(:,1)+gc(:,2)'*H{2,2}*vp(:,2) )^2  );

SINR_P(1)=(   norm( gp(:,1)'*H{1,1}*vp(:,1) )^2   )/( norm( gp(:,1)'*sigma^2*gp(:,1) ) +  norm( gp(:,1)'*H{1,1}*vc(:,1)+gp(:,1)'*H{1,2}*vc(:,2)+gp(:,1)'*H{1,2}*vp(:,2) )^2  );
SINR_P(2)=(   norm( gp(:,2)'*H{2,2}*vp(:,2) )^2   )/( norm( gp(:,2)'*sigma^2*gp(:,2) ) +  norm( gp(:,2)'*H{2,1}*vc(:,1)+gp(:,2)'*H{2,2}*vc(:,2)+gp(:,2)'*H{2,1}*vp(:,1) )^2  );



C=0;
for i = 1:2
    
    C=C+log2(1+SINR_C(i))+log2(1+SINR_P(i))
    
end


